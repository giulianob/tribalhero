<project name="gameserver" default="compile" basedir="." xmlns:dn="antlib:org.apache.ant.dotnet" xmlns="antlib:org.apache.tools.ant">
	<description>Game server build</description>
	
	<target name="init">
		<echo message="Building from ${basedir}" />
	
		<tstamp />
		
		<property name="src" location="game/src" />
			
		<!-- Make bin dir -->
		<delete dir="bin" />
		<mkdir dir="bin" />		
	</target>
	
	<target name="compile" depends="init">
		<dn:msbuild buildfile="${basedir}\Game.sln">
			<target name="Game:Rebuild" />
			<target name="CSVToXML:Rebuild" />
			<target name="DatabaseGenerator:Rebuild" />
			<target name="GraphGenerator:Rebuild" />
			<target name="Launcher:Rebuild" />
			<target name="LauncherService:Rebuild" />
			
			<property name="Configuration" value="Release" />
			<property name="Platform" value="any cpu" />
			<property name="BuildProjectReferences" value="false" />
		</dn:msbuild>
	</target>
	
	<target name="deploy" if="deploydir" depends="compile">
		<mkdir dir="${deploydir}" />
		
		<!-- Zip launcher -->
		<zip destfile="${deploydir}/Launcher.zip">
			<zipfileset dir="${basedir}/Launcher/bin/Release" prefix="bin" />
			<zipfileset dir="${basedir}/conf" prefix="conf" />			
		</zip>
		 
		<zip destfile="${deploydir}/LauncherService.zip">
			<zipfileset dir="${basedir}/LauncherService/bin/Release" prefix="bin" />
			<zipfileset dir="${basedir}/conf" prefix="conf" />			
		</zip>		
		
	</target>
</project>